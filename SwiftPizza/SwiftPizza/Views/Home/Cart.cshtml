@model SwiftPizza.Views.Home.CartModel

<style>
    .container {
        display: flex;
        height: 100vh;
        overflow: hidden;
    }

    .section {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
    }

    .white-table th, .white-table td {
        color: white !important;
    }
</style>

@{
    var isAscSelected = Model.SortOrder == "asc" ? "selected" : "";
    var isDescSelected = Model.SortOrder == "desc" ? "selected" : "";
}


<div class="container">
    <div class="section">
        <form method="get">
            <input type="text" name="SearchTerm" placeholder="Search..." value="@Model.SearchTerm" />
            <select name="SortOrder">
                <option value="asc" selected="@isAscSelected">Ascending</option>
                <option value="desc" selected="@isDescSelected">Descending</option>
            </select>
            <button type="submit">Filter & Sort</button>
        </form>
        <h2>Menu</h2>
        @foreach (var pizza in Model.Pizzas)
        {
            <div>
                <img src="@pizza.PizzaImage" alt="@pizza.PizzaName" width="100" height="100" style="border-radius: 15px;">
                <br>
                <span>@pizza.PizzaName</span> - <small>@pizza.PizzaDescription</small>
                <button onclick="addPizzaToCart('@pizza.PizzaId', '@pizza.PizzaName', @pizza.PizzaPrice)">+</button>
                <button onclick="removePizzaFromCart('@pizza.PizzaId')">-</button>
            </div>
        }
    </div>

    <!-- Right section for Cart -->
    <div class="section">
        <h2>Your Cart</h2>
        <div id="cartItems"></div>
        <div>
            Total: $<span id="totalPrice">0</span>
        </div>
    </div>
</div>

<script>
    let cart = {};

    function updateCartDisplay() {
        const cartItemsDiv = document.getElementById('cartItems');
        let totalPrice = 0;
        let itemsHtml = '';

        for (let pizzaId in cart) {
            const pizza = cart[pizzaId];
            totalPrice += pizza.price * pizza.quantity;
            itemsHtml += `<div>${pizza.name} x ${pizza.quantity} = $${pizza.price * pizza.quantity}</div>`;
        }

        cartItemsDiv.innerHTML = itemsHtml;
        document.getElementById('totalPrice').innerText = totalPrice;
    }

    function addPizzaToCart(pizzaId, pizzaName, pizzaPrice) {
        if (!cart[pizzaId]) {
            cart[pizzaId] = { name: pizzaName, price: pizzaPrice, quantity: 0 };
        }

        cart[pizzaId].quantity++;
        updateCartDisplay();
    }

    function removePizzaFromCart(pizzaId) {
        if (cart[pizzaId] && cart[pizzaId].quantity > 0) {
            cart[pizzaId].quantity--;

            if (cart[pizzaId].quantity === 0) {
                delete cart[pizzaId];
            }

            updateCartDisplay();
        }
    }
</script>
